@using MicroSocialPlatform.Data
@model Post 
@inject ApplicationDbContext DbContext;
@{
    Layout = "MyLayout";
    int num_comments = DbContext.Comments.Count(c => c.PostId == Model.Id);
}
<section class="post-with-comments">
    <div class="post-s">
        <div class="post-header-s">
            <img src="https://cdn.pixabay.com/photo/2015/04/23/21/59/tree-736877__480.jpg" class="user-icon" alt="">
            <p class="username">@Model.User.UserName</p>
            <div class="edit-post-btn">
                <i class="fa fa-ellipsis-v" aria-hidden="true"></i>
            </div>
        </div>
        <form method="post" asp-route="delete_post" asp-route-id="@Model.Id">
            <button type="submit">

            </button>
        </form>
        <div class="post-feed-s">
            <div class="post-img-container-s">
                <div class="text-cont">
                    <p class="text">@Model.Content</p>
                </div>
                <img src="https://cdn.pixabay.com/photo/2015/04/23/21/59/tree-736877__480.jpg" alt="">
            </div>
        </div>

        <div class="post-detail-s">
            <div class="detail-intracables-s">
                <ion-icon class="lbut" name="heart-outline"></ion-icon>
                <ion-icon class="cbut" name="chatbubble-ellipses"></ion-icon>
            </div>

            <span class="likes">3.4k</span>
            <span class="comment-count">@num_comments</span>

        </div>
        <div class="comments-s">
            @foreach (var comment in Model.Comments)
            {
                @Html.Partial("CommentPartial", comment)
            }

            @using (Html.BeginForm("Index", "Post", method: FormMethod.Post, htmlAttributes: new { @class = "comment-box" }))
            {
                <input type="hidden" name="PostId" value="@Model.Id"></input>
                <input name="Content" type="text" id="comment-input"></input>
                @Html.ValidationMessage("Content", null)
                <button class="add-comment-btn" type="submit">Post</button>
            }

        </div>
        <div class="set-divs hid">
            <form method="get" asp-route="edit_post" asp-route-id="@Model.Id" style="display: contents;">
                <button type="submit" class="edit-post-button">
                    <ion-icon name="create-outline"></ion-icon>
                    <p>Edit</p>
                </button>
            </form>
            <form method="post" asp-route="delete_post" asp-route-id="@Model.Id" style="display: contents;">
                <button type="submit" class="delete-post-button">
                    <ion-icon name="trash-outline"></ion-icon>
                    <p>Delete</p>
                </button>
            </form>
        </div>
    </div>
</section>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
<script>
    const delete_buttons = document.querySelector('.set-divs')
    $(document).ready(function() {
        document.querySelector('.edit-post-btn').addEventListener("click",function() {
                                                                         
            if(delete_buttons.classList.contains('hid')){
                delete_buttons.classList.remove('hid');
                delete_buttons.classList.add('active');
            }
            else{
                delete_buttons.classList.remove('active');
                delete_buttons.classList.add('hid');
            }
                                                                    
        })
    });

</script>